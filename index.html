<!doctype html>
<html lang="id" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, viewport-fit=cover">
  <title>BPJN Chat Assistant</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="/_sdk/element_sdk.js"></script>
  <script src="/_sdk/data_sdk.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700&amp;display=swap" rel="stylesheet">
  <style>
    * {
      -webkit-tap-highlight-color: transparent;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Plus Jakarta Sans', sans-serif;
    }
    
    html, body {
      width: 100%;
      height: 100%;
      margin: 0;
      padding: 0;
      overflow: hidden;
    }
    
    #app {
      width: 100%;
      height: 100%;
      overflow: hidden;
    }
    
    .gradient-bg {
      background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
    }
    
    .chat-bubble-user {
      background: linear-gradient(135deg, #1e3a5f 0%, #2d4a6f 100%);
      word-wrap: break-word;
      overflow-wrap: break-word;
      hyphens: auto;
    }
    
    .chat-bubble-bot {
      background: #ffffff;
      border: 1px solid #e2e8f0;
      word-wrap: break-word;
      overflow-wrap: break-word;
      hyphens: auto;
    }
    
    .floating-animation {
      animation: float 3s ease-in-out infinite;
    }
    
    @keyframes float {
      0%, 100% { transform: translateY(0px); }
      50% { transform: translateY(-10px); }
    }
    
    .fade-in {
      animation: fadeIn 0.5s ease-out;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .slide-up {
      animation: slideUp 0.3s ease-out;
    }
    
    @keyframes slideUp {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .pulse-dot {
      animation: pulse 1.5s ease-in-out infinite;
    }
    
    @keyframes pulse {
      0%, 100% { opacity: 0.4; }
      50% { opacity: 1; }
    }
    
    ::-webkit-scrollbar {
      width: 6px;
    }
    
    ::-webkit-scrollbar-track {
      background: #f1f5f9;
    }
    
    ::-webkit-scrollbar-thumb {
      background: #cbd5e1;
      border-radius: 10px;
    }
    
    ::-webkit-scrollbar-thumb:hover {
      background: #94a3b8;
    }
    
    #landing-page {
      width: 100%;
      height: 100%;
      overflow-y: auto;
      -webkit-overflow-scrolling: touch;
    }
    
    #chat-page {
      width: 100%;
      height: 100%;
      display: none;
      flex-direction: column;
    }
    
    #chat-page.show {
      display: flex;
    }
    
    #chat-messages {
      flex: 1;
      overflow-y: auto;
      -webkit-overflow-scrolling: touch;
    }
    
    @media (max-width: 768px) {
      input[type="text"], button, textarea {
        font-size: 16px;
      }
      
      .hero-section {
        padding: 2rem 1rem;
      }
      
      .quick-action-btn {
        font-size: 0.875rem;
        padding: 0.5rem 1rem;
      }
      
      .chat-container {
        border-radius: 1rem;
      }
      
      .chat-input-form {
        gap: 0.5rem;
      }
      
      #message-input {
        min-height: 44px;
      }
      
      #send-button {
        min-height: 44px;
        min-width: 44px;
      }
    }
    
    @media (max-width: 480px) {
      .nav-desktop {
        display: none;
      }
      
      .nav-mobile {
        display: flex;
      }
      
      .feature-grid {
        grid-template-columns: 1fr;
      }
      
      .cta-section {
        padding: 2rem 1rem;
      }
      
      .quick-action-btn {
        font-size: 0.75rem;
        padding: 0.5rem 0.75rem;
      }
    }
    
    .safe-area-bottom {
      padding-bottom: max(1rem, env(safe-area-inset-bottom));
    }
    
    .safe-area-top {
      padding-top: max(0.5rem, env(safe-area-inset-top));
    }
  </style>
  <style>@view-transition { navigation: auto; }</style>
 </head>
 <body class="h-full bg-white">
  <div id="app" class="h-full w-full"><!-- Landing Page -->
   <div id="landing-page" class="w-full"><!-- Navigation -->
    <nav class="w-full px-4 sm:px-6 py-3 sm:py-4 flex items-center justify-between max-w-7xl mx-auto sticky top-0 z-50 bg-white shadow-sm">
     <div class="flex items-center gap-2 sm:gap-3">
      <div class="w-8 sm:w-10 h-8 sm:h-10 rounded-lg sm:rounded-xl flex items-center justify-center flex-shrink-0" style="background: #1e3a5f;">
       <svg width="20" height="20" viewbox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="sm:w-6 sm:h-6"><path d="M12 2L2 7L12 12L22 7L12 2Z" fill="#f7c948" /> <path d="M2 17L12 22L22 17" stroke="#f7c948" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /> <path d="M2 12L12 17L22 12" stroke="#f7c948" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
       </svg>
      </div><span class="font-bold text-lg sm:text-xl" style="color: #1e3a5f;">BPJN</span>
     </div><button onclick="showChat()" class="px-4 sm:px-5 py-2 sm:py-2.5 rounded-full font-medium text-white text-sm sm:text-base transition-all hover:shadow-lg hover:scale-105 touch-feedback" style="background: #1e3a5f;"> Chat </button>
    </nav><!-- Hero Section -->
    <section class="px-4 sm:px-6 py-8 sm:py-16 max-w-7xl mx-auto w-full">
     <div class="flex flex-col lg:flex-row items-center gap-8 lg:gap-12">
      <div class="flex-1 text-center lg:text-left w-full">
       <div class="inline-flex items-center gap-2 px-3 sm:px-4 py-2 rounded-full mb-4 sm:mb-6 text-xs sm:text-sm" style="background: rgba(247, 201, 72, 0.2);"><span class="w-2 h-2 rounded-full" style="background: #f7c948;"></span> <span class="font-medium" style="color: #1e3a5f;">Online 24/7</span>
       </div>
       <h1 id="hero-title" class="text-2xl sm:text-4xl lg:text-5xl font-bold mb-4 sm:mb-6 leading-tight" style="color: #1e3a5f;">Asisten Virtual BPJN Siap Membantu Anda</h1>
       <p id="hero-subtitle" class="text-base sm:text-lg mb-6 sm:mb-8 leading-relaxed" style="color: #64748b;">Dapatkan informasi dan bantuan seputar layanan BPJN dengan cepat dan mudah melalui chat assistant kami.</p>
       <div class="flex flex-col sm:flex-row gap-3 sm:gap-4 justify-center lg:justify-start"><button id="cta-button" onclick="showChat()" class="px-6 sm:px-8 py-3 sm:py-4 rounded-lg sm:rounded-xl font-semibold text-white text-sm sm:text-base transition-all hover:shadow-xl hover:scale-105 flex items-center justify-center gap-2 touch-feedback" style="background: #1e3a5f;">
         <svg width="18" height="18" viewbox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M21 11.5C21.0034 12.8199 20.6951 14.1219 20.1 15.3C19.3944 16.7118 18.3098 17.8992 16.9674 18.7293C15.6251 19.5594 14.0782 19.9994 12.5 20C11.1801 20.0035 9.87812 19.6951 8.7 19.1L3 21L4.9 15.3C4.30493 14.1219 3.99656 12.8199 4 11.5C4.00061 9.92179 4.44061 8.37488 5.27072 7.03258C6.10083 5.69028 7.28825 4.6056 8.7 3.90003C9.87812 3.30496 11.1801 2.99659 12.5 3.00003H13C15.0843 3.11502 17.053 3.99479 18.5291 5.47089C20.0052 6.94699 20.885 8.91568 21 11V11.5Z" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
         </svg><span>Mulai Chat</span> </button> <button class="px-6 sm:px-8 py-3 sm:py-4 rounded-lg sm:rounded-xl font-semibold text-sm sm:text-base transition-all hover:bg-gray-100 flex items-center justify-center gap-2 touch-feedback" style="color: #1e3a5f; border: 2px solid #e2e8f0;">
         <svg width="18" height="18" viewbox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" r="10" stroke="#1e3a5f" stroke-width="2" /> <path d="M12 16V12" stroke="#1e3a5f" stroke-width="2" stroke-linecap="round" /> <circle cx="12" cy="8" r="1" fill="#1e3a5f" />
         </svg><span>Pelajari</span> </button>
       </div>
      </div><!-- Mobile: Hide large illustration, show on desktop only -->
      <div class="hidden lg:flex flex-1 justify-center w-full">
       <div class="relative floating-animation max-w-sm w-full">
        <div class="w-full max-w-sm h-96 rounded-3xl shadow-2xl p-4 bg-white">
         <div class="w-full h-full rounded-2xl overflow-hidden" style="background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);">
          <div class="p-4 text-sm">
           <div class="flex items-center gap-3 mb-4">
            <div class="w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0" style="background: #1e3a5f;">
             <svg width="16" height="16" viewbox="0 0 24 24" fill="none"><path d="M12 2C6.48 2 2 6.48 2 12C2 17.52 6.48 22 12 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 12 2ZM12 5C13.66 5 15 6.34 15 8C15 9.66 13.66 11 12 11C10.34 11 9 9.66 9 8C9 6.34 10.34 5 12 5ZM12 19.2C9.5 19.2 7.29 17.92 6 15.98C6.03 13.99 10 12.9 12 12.9C13.99 12.9 17.97 13.99 18 15.98C16.71 17.92 14.5 19.2 12 19.2Z" fill="white" />
             </svg>
            </div>
            <div>
             <p class="font-semibold" style="color: #1e3a5f;">BPJN Assistant</p>
             <p class="text-xs" style="color: #94a3b8;">Online</p>
            </div>
           </div>
           <div class="space-y-3">
            <div class="bg-white rounded-2xl rounded-tl-sm p-3 shadow-sm max-w-[85%]">
             <p style="color: #1e3a5f;">Halo! Ada yang bisa saya bantu? üëã</p>
            </div>
            <div class="ml-auto rounded-2xl rounded-tr-sm p-3 max-w-[85%]" style="background: #1e3a5f;">
             <p class="text-white text-xs">Informasi layanan</p>
            </div>
            <div class="bg-white rounded-2xl rounded-tl-sm p-3 shadow-sm max-w-[85%]">
             <p style="color: #1e3a5f;">Tentu! Berikut layanan kami...</p>
            </div>
           </div>
          </div>
         </div>
        </div>
        <div class="absolute -top-4 -right-4 w-20 h-20 rounded-full opacity-20" style="background: #f7c948;"></div>
        <div class="absolute -bottom-6 -left-6 w-16 h-16 rounded-full opacity-30" style="background: #1e3a5f;"></div>
       </div>
      </div>
     </div>
    </section><!-- Features Section -->
    <section class="px-4 sm:px-6 py-8 sm:py-16 bg-white">
     <div class="max-w-7xl mx-auto w-full">
      <div class="text-center mb-8 sm:mb-12">
       <h2 class="text-2xl sm:text-3xl font-bold mb-3 sm:mb-4" style="color: #1e3a5f;">Mengapa Memilih Kami?</h2>
       <p class="text-sm sm:text-base" style="color: #64748b;">Fitur unggulan yang memudahkan Anda</p>
      </div>
      <div class="feature-grid grid md:grid-cols-3 gap-4 sm:gap-6 lg:gap-8"><!-- Feature 1 -->
       <div class="p-6 sm:p-8 rounded-xl sm:rounded-2xl text-center transition-all hover:shadow-xl hover:-translate-y-2" style="background: linear-gradient(135deg, #f8fafc 0%, #ffffff 100%); border: 1px solid #e2e8f0;">
        <div class="w-12 sm:w-16 h-12 sm:h-16 rounded-lg sm:rounded-2xl flex items-center justify-center mx-auto mb-4 sm:mb-6" style="background: rgba(247, 201, 72, 0.2);">
         <svg width="24" height="24" viewbox="0 0 24 24" fill="none" class="sm:w-8 sm:h-8"><path d="M13 2L3 14H12L11 22L21 10H12L13 2Z" fill="#f7c948" />
         </svg>
        </div>
        <h3 id="feature1-title" class="text-lg sm:text-xl font-bold mb-2 sm:mb-3" style="color: #1e3a5f;">Respons Cepat</h3>
        <p class="text-xs sm:text-sm" style="color: #64748b;">Dapatkan jawaban instan untuk setiap pertanyaan Anda tanpa menunggu lama.</p>
       </div><!-- Feature 2 -->
       <div class="p-6 sm:p-8 rounded-xl sm:rounded-2xl text-center transition-all hover:shadow-xl hover:-translate-y-2" style="background: linear-gradient(135deg, #f8fafc 0%, #ffffff 100%); border: 1px solid #e2e8f0;">
        <div class="w-12 sm:w-16 h-12 sm:h-16 rounded-lg sm:rounded-2xl flex items-center justify-center mx-auto mb-4 sm:mb-6" style="background: rgba(30, 58, 95, 0.1);">
         <svg width="24" height="24" viewbox="0 0 24 24" fill="none" class="sm:w-8 sm:h-8"><circle cx="12" cy="12" r="10" stroke="#1e3a5f" stroke-width="2" /> <path d="M12 6V12L16 14" stroke="#1e3a5f" stroke-width="2" stroke-linecap="round" />
         </svg>
        </div>
        <h3 id="feature2-title" class="text-lg sm:text-xl font-bold mb-2 sm:mb-3" style="color: #1e3a5f;">24/7 Online</h3>
        <p class="text-xs sm:text-sm" style="color: #64748b;">Layanan tersedia sepanjang waktu, kapanpun Anda membutuhkan bantuan.</p>
       </div><!-- Feature 3 -->
       <div class="p-6 sm:p-8 rounded-xl sm:rounded-2xl text-center transition-all hover:shadow-xl hover:-translate-y-2" style="background: linear-gradient(135deg, #f8fafc 0%, #ffffff 100%); border: 1px solid #e2e8f0;">
        <div class="w-12 sm:w-16 h-12 sm:h-16 rounded-lg sm:rounded-2xl flex items-center justify-center mx-auto mb-4 sm:mb-6" style="background: rgba(247, 201, 72, 0.2);">
         <svg width="24" height="24" viewbox="0 0 24 24" fill="none" class="sm:w-8 sm:h-8"><path d="M9 12L11 14L15 10" stroke="#f7c948" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /> <path d="M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z" stroke="#f7c948" stroke-width="2" />
         </svg>
        </div>
        <h3 id="feature3-title" class="text-lg sm:text-xl font-bold mb-2 sm:mb-3" style="color: #1e3a5f;">Informasi Akurat</h3>
        <p class="text-xs sm:text-sm" style="color: #64748b;">Informasi terpercaya dan selalu diperbarui sesuai kebijakan terbaru.</p>
       </div>
      </div>
     </div>
    </section><!-- CTA Section -->
    <section class="px-4 sm:px-6 py-8 sm:py-16">
     <div class="cta-section max-w-4xl mx-auto rounded-2xl sm:rounded-3xl p-6 sm:p-12 text-center w-full" style="background: linear-gradient(135deg, #1e3a5f 0%, #2d4a6f 100%);">
      <h2 class="text-2xl sm:text-3xl font-bold text-white mb-3 sm:mb-4">Siap Untuk Memulai?</h2>
      <p class="text-base sm:text-lg mb-6 sm:mb-8 leading-relaxed" style="color: rgba(255,255,255,0.8);">Mulai percakapan dengan asisten kami sekarang dan dapatkan bantuan yang Anda butuhkan.</p><button onclick="showChat()" class="px-6 sm:px-8 py-3 sm:py-4 rounded-lg sm:rounded-xl font-semibold transition-all hover:scale-105 flex items-center justify-center gap-2 mx-auto text-sm sm:text-base touch-feedback" style="background: #f7c948; color: #1e3a5f;">
       <svg width="18" height="18" viewbox="0 0 24 24" fill="none" class="sm:w-5 sm:h-5"><path d="M21 11.5C21.0034 12.8199 20.6951 14.1219 20.1 15.3C19.3944 16.7118 18.3098 17.8992 16.9674 18.7293C15.6251 19.5594 14.0782 19.9994 12.5 20C11.1801 20.0035 9.87812 19.6951 8.7 19.1L3 21L4.9 15.3C4.30493 14.1219 3.99656 12.8199 4 11.5C4.00061 9.92179 4.44061 8.37488 5.27072 7.03258C6.10083 5.69028 7.28825 4.6056 8.7 3.90003C9.87812 3.30496 11.1801 2.99659 12.5 3.00003H13C15.0843 3.11502 17.053 3.99479 18.5291 5.47089C20.0052 6.94699 20.885 8.91568 21 11V11.5Z" stroke="#1e3a5f" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
       </svg><span>Mulai Chat Sekarang</span> </button>
     </div>
    </section><!-- Footer -->
    <footer class="px-4 sm:px-6 py-6 sm:py-8 border-t" style="border-color: #e2e8f0;">
     <div class="max-w-7xl mx-auto w-full flex flex-col sm:flex-row items-center justify-between gap-3 sm:gap-4 text-center sm:text-left">
      <div class="flex items-center gap-2">
       <div class="w-6 h-6 sm:w-8 sm:h-8 rounded flex items-center justify-center flex-shrink-0" style="background: #1e3a5f;">
        <svg width="12" height="12" viewbox="0 0 24 24" fill="none" class="sm:w-4 sm:h-4"><path d="M12 2L2 7L12 12L22 7L12 2Z" fill="#f7c948" /> <path d="M2 17L12 22L22 17" stroke="#f7c948" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /> <path d="M2 12L12 17L22 12" stroke="#f7c948" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
        </svg>
       </div><span id="footer-text" class="text-xs sm:text-sm" style="color: #64748b;">¬© 2024 BPJN. Semua Hak Dilindungi.</span>
      </div>
      <div class="flex items-center gap-3 sm:gap-6 flex-wrap justify-center sm:justify-start"><a href="#" class="text-xs sm:text-sm hover:underline" style="color: #64748b;">Privasi</a> <a href="#" class="text-xs sm:text-sm hover:underline" style="color: #64748b;">Syarat</a> <a href="#" class="text-xs sm:text-sm hover:underline" style="color: #64748b;">Kontak</a>
      </div>
     </div>
    </footer>
   </div><!-- Chat Page -->
   <div id="chat-page" class="w-full" style="background: #f8fafc;"><!-- Chat Header -->
    <div class="w-full px-3 sm:px-4 py-3 flex items-center gap-3 sm:gap-4 shadow-sm safe-area-top" style="background: #1e3a5f;"><button onclick="showLanding()" class="p-2 rounded-full hover:bg-white/10 transition-colors flex-shrink-0 touch-feedback">
      <svg width="22" height="22" viewbox="0 0 24 24" fill="none" class="sm:w-6 sm:h-6"><path d="M19 12H5M12 19L5 12L12 5" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
      </svg></button>
     <div class="w-8 h-8 sm:w-10 sm:h-10 rounded-full flex items-center justify-center flex-shrink-0" style="background: rgba(247, 201, 72, 0.2);">
      <svg width="18" height="18" viewbox="0 0 24 24" fill="none" class="sm:w-6 sm:h-6"><path d="M12 2C6.48 2 2 6.48 2 12C2 17.52 6.48 22 12 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 12 2ZM12 5C13.66 5 15 6.34 15 8C15 9.66 13.66 11 12 11C10.34 11 9 9.66 9 8C9 6.34 10.34 5 12 5ZM12 19.2C9.5 19.2 7.29 17.92 6 15.98C6.03 13.99 10 12.9 12 12.9C13.99 12.9 17.97 13.99 18 15.98C16.71 17.92 14.5 19.2 12 19.2Z" fill="#f7c948" />
      </svg>
     </div>
     <div class="flex-1 min-w-0">
      <h2 class="font-semibold text-white text-sm sm:text-base truncate">BPJN Assistant</h2>
      <div class="flex items-center gap-2"><span class="w-2 h-2 rounded-full" style="background: #22c55e;"></span> <span class="text-xs sm:text-sm" style="color: rgba(255,255,255,0.8);">Online</span>
      </div>
     </div><button onclick="clearChat()" class="p-2 rounded-full hover:bg-white/10 transition-colors flex-shrink-0 touch-feedback" title="Hapus Chat">
      <svg width="18" height="18" viewbox="0 0 24 24" fill="none" class="sm:w-5 sm:h-5"><path d="M3 6H5H21" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /> <path d="M8 6V4C8 3.46957 8.21071 2.96086 8.58579 2.58579C8.96086 2.21071 9.46957 2 10 2H14C14.5304 2 15.0391 2.21071 15.4142 2.58579C15.7893 2.96086 16 3.46957 16 4V6M19 6V20C19 20.5304 18.7893 21.0391 18.4142 21.4142C18.0391 21.7893 17.5304 22 17 22H7C6.46957 22 5.96086 21.7893 5.58579 21.4142C5.21071 21.0391 5 20.5304 5 20V6H19Z" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
      </svg></button>
    </div><!-- Chat Messages -->
    <div id="chat-messages" class="flex-1 overflow-auto p-3 sm:p-4 space-y-4"><!-- Welcome Message -->
     <div class="flex gap-3 fade-in">
      <div class="w-7 h-7 sm:w-8 sm:h-8 rounded-full flex-shrink-0 flex items-center justify-center" style="background: #1e3a5f;">
       <svg width="14" height="14" viewbox="0 0 24 24" fill="none" class="sm:w-4 sm:h-4"><path d="M12 2C6.48 2 2 6.48 2 12C2 17.52 6.48 22 12 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 12 2ZM12 5C13.66 5 15 6.34 15 8C15 9.66 13.66 11 12 11C10.34 11 9 9.66 9 8C9 6.34 10.34 5 12 5ZM12 19.2C9.5 19.2 7.29 17.92 6 15.98C6.03 13.99 10 12.9 12 12.9C13.99 12.9 17.97 13.99 18 15.98C16.71 17.92 14.5 19.2 12 19.2Z" fill="#f7c948" />
       </svg>
      </div>
      <div class="chat-bubble-bot rounded-2xl rounded-tl-sm p-3 sm:p-4 max-w-[85%] sm:max-w-[70%] shadow-sm text-sm sm:text-base">
       <p style="color: #1e3a5f;">Halo! üëã Selamat datang di BPJN Chat Assistant. Saya siap membantu Anda dengan informasi seputar layanan BPJN. Ada yang bisa saya bantu hari ini?</p>
      </div>
     </div><!-- Quick Actions -->
     <div class="flex flex-wrap gap-2 pl-10 sm:pl-12"><button onclick="sendQuickMessage('Informasi layanan BPJN')" class="quick-action-btn px-3 sm:px-4 py-2 rounded-full text-xs sm:text-sm font-medium transition-all hover:scale-105 touch-feedback" style="background: rgba(247, 201, 72, 0.2); color: #1e3a5f;"> üìã Layanan </button> <button onclick="sendQuickMessage('Cara mengajukan permohonan')" class="quick-action-btn px-3 sm:px-4 py-2 rounded-full text-xs sm:text-sm font-medium transition-all hover:scale-105 touch-feedback" style="background: rgba(247, 201, 72, 0.2); color: #1e3a5f;"> üìù Pengajuan </button> <button onclick="sendQuickMessage('Kontak dan lokasi kantor')" class="quick-action-btn px-3 sm:px-4 py-2 rounded-full text-xs sm:text-sm font-medium transition-all hover:scale-105 touch-feedback" style="background: rgba(247, 201, 72, 0.2); color: #1e3a5f;"> üìç Lokasi </button>
     </div>
    </div><!-- Chat Input -->
    <div class="w-full p-3 sm:p-4 safe-area-bottom" style="background: white; border-top: 1px solid #e2e8f0;">
     <form id="chat-form" class="chat-input-form flex gap-2 sm:gap-3"><input type="text" id="message-input" placeholder="Pesan..." class="flex-1 px-3 sm:px-4 py-2 sm:py-3 rounded-lg sm:rounded-xl border-2 focus:outline-none transition-colors text-sm sm:text-base" style="border-color: #e2e8f0; background: #f8fafc;" onfocus="this.style.borderColor='#1e3a5f'" onblur="this.style.borderColor='#e2e8f0'"> <button type="submit" id="send-button" class="px-3 sm:px-4 py-2 sm:py-3 rounded-lg sm:rounded-xl font-medium text-white transition-all hover:shadow-lg hover:scale-105 flex items-center justify-center gap-1 sm:gap-2 flex-shrink-0 touch-feedback text-sm sm:text-base min-h-10 sm:min-h-11" style="background: #1e3a5f;"> <span class="hidden sm:inline">Kirim</span>
       <svg width="16" height="16" viewbox="0 0 24 24" fill="none" class="sm:w-5 sm:h-5"><path d="M22 2L11 13" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /> <path d="M22 2L15 22L11 13L2 9L22 2Z" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
       </svg></button>
     </form>
    </div>
   </div>
  </div>
  <script>
    const defaultConfig = {
      hero_title: 'Asisten Virtual BPJN Siap Membantu Anda',
      hero_subtitle: 'Dapatkan informasi dan bantuan seputar layanan BPJN dengan cepat dan mudah melalui chat assistant kami.',
      cta_button_text: 'Mulai Percakapan',
      feature1_title: 'Respons Cepat',
      feature2_title: '24/7 Online',
      feature3_title: 'Informasi Akurat',
      footer_text: '¬© 2024 BPJN. Semua Hak Dilindungi.',
      background_color: '#ffffff',
      primary_color: '#1e3a5f',
      accent_color: '#f7c948',
      text_color: '#1e3a5f',
      secondary_text_color: '#64748b',
      font_family: 'Plus Jakarta Sans',
      font_size: 16
    };

    let chatMessages = [];
    let currentRecordCount = 0;

    const botResponses = {
      'informasi layanan bpjn': 'BPJN (Balai Pelaksana Jalan Nasional) menyediakan berbagai layanan terkait infrastruktur jalan, antara lain:\n\nüìã Pembangunan dan pemeliharaan jalan nasional\nüìã Pengawasan proyek infrastruktur\nüìã Konsultasi teknis jalan dan jembatan\nüìã Informasi status proyek\n\nApakah ada layanan spesifik yang ingin Anda ketahui lebih lanjut?',
      'cara mengajukan permohonan': 'Untuk mengajukan permohonan di BPJN, Anda dapat mengikuti langkah-langkah berikut:\n\n1Ô∏è‚É£ Siapkan dokumen persyaratan\n2Ô∏è‚É£ Kunjungi kantor BPJN terdekat atau akses portal online\n3Ô∏è‚É£ Isi formulir permohonan\n4Ô∏è‚É£ Serahkan dokumen dan formulir\n5Ô∏è‚É£ Tunggu proses verifikasi\n\nPerlu bantuan dengan jenis permohonan tertentu?',
      'kontak dan lokasi kantor': 'Berikut informasi kontak BPJN:\n\nüìç Alamat: Jl. Raya BPJN No. 1\nüìû Telepon: (021) 1234-5678\nüìß Email: info@bpjn.go.id\nüïê Jam Operasional: Senin-Jumat, 08.00-16.00 WIB\n\nAnda juga dapat mengunjungi website resmi untuk informasi lebih lengkap.'
    };

    function getDefaultResponse(message) {
      const responses = [
        'Terima kasih atas pertanyaannya! Untuk informasi lebih detail mengenai "' + message + '", silakan hubungi kantor BPJN terdekat atau kunjungi website resmi kami.',
        'Pertanyaan yang bagus! Saya akan membantu Anda mencari informasi tentang "' + message + '". Mohon tunggu sebentar atau gunakan tombol quick action di atas untuk topik spesifik.',
        'Saya memahami pertanyaan Anda tentang "' + message + '". Untuk mendapatkan jawaban yang akurat, saya sarankan untuk menghubungi langsung layanan pelanggan BPJN.'
      ];
      return responses[Math.floor(Math.random() * responses.length)];
    }

    function getBotResponse(userMessage) {
      const lowerMessage = userMessage.toLowerCase();
      for (const [key, response] of Object.entries(botResponses)) {
        if (lowerMessage.includes(key)) {
          return response;
        }
      }
      return getDefaultResponse(userMessage);
    }

    const dataHandler = {
      onDataChanged(data) {
        currentRecordCount = data.length;
        chatMessages = data.sort((a, b) => new Date(a.timestamp) - new Date(b.timestamp));
        renderMessages();
      }
    };

    function renderMessages() {
      const container = document.getElementById('chat-messages');
      
      const welcomeHTML = `
        <div class="flex gap-3 fade-in">
          <div class="w-7 h-7 sm:w-8 sm:h-8 rounded-full flex-shrink-0 flex items-center justify-center" style="background: #1e3a5f;">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" class="sm:w-4 sm:h-4">
              <path d="M12 2C6.48 2 2 6.48 2 12C2 17.52 6.48 22 12 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 12 2ZM12 5C13.66 5 15 6.34 15 8C15 9.66 13.66 11 12 11C10.34 11 9 9.66 9 8C9 6.34 10.34 5 12 5ZM12 19.2C9.5 19.2 7.29 17.92 6 15.98C6.03 13.99 10 12.9 12 12.9C13.99 12.9 17.97 13.99 18 15.98C16.71 17.92 14.5 19.2 12 19.2Z" fill="#f7c948"/>
            </svg>
          </div>
          <div class="chat-bubble-bot rounded-2xl rounded-tl-sm p-3 sm:p-4 max-w-[85%] sm:max-w-[70%] shadow-sm text-sm sm:text-base">
            <p style="color: #1e3a5f;">Halo! üëã Selamat datang di BPJN Chat Assistant. Saya siap membantu Anda dengan informasi seputar layanan BPJN. Ada yang bisa saya bantu hari ini?</p>
          </div>
        </div>
        <div class="flex flex-wrap gap-2 pl-10 sm:pl-12">
          <button onclick="sendQuickMessage('Informasi layanan BPJN')" class="quick-action-btn px-3 sm:px-4 py-2 rounded-full text-xs sm:text-sm font-medium transition-all hover:scale-105 touch-feedback" style="background: rgba(247, 201, 72, 0.2); color: #1e3a5f;">
            üìã Layanan
          </button>
          <button onclick="sendQuickMessage('Cara mengajukan permohonan')" class="quick-action-btn px-3 sm:px-4 py-2 rounded-full text-xs sm:text-sm font-medium transition-all hover:scale-105 touch-feedback" style="background: rgba(247, 201, 72, 0.2); color: #1e3a5f;">
            üìù Pengajuan
          </button>
          <button onclick="sendQuickMessage('Kontak dan lokasi kantor')" class="quick-action-btn px-3 sm:px-4 py-2 rounded-full text-xs sm:text-sm font-medium transition-all hover:scale-105 touch-feedback" style="background: rgba(247, 201, 72, 0.2); color: #1e3a5f;">
            üìç Lokasi
          </button>
        </div>
      `;

      let messagesHTML = '';
      chatMessages.forEach(msg => {
        if (msg.sender === 'user') {
          messagesHTML += `
            <div class="flex justify-end slide-up">
              <div class="chat-bubble-user rounded-2xl rounded-tr-sm p-3 sm:p-4 max-w-[85%] sm:max-w-[70%] text-sm sm:text-base">
                <p class="text-white">${escapeHtml(msg.message)}</p>
              </div>
            </div>
          `;
        } else {
          messagesHTML += `
            <div class="flex gap-3 slide-up">
              <div class="w-7 h-7 sm:w-8 sm:h-8 rounded-full flex-shrink-0 flex items-center justify-center" style="background: #1e3a5f;">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" class="sm:w-4 sm:h-4">
                  <path d="M12 2C6.48 2 2 6.48 2 12C2 17.52 6.48 22 12 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 12 2ZM12 5C13.66 5 15 6.34 15 8C15 9.66 13.66 11 12 11C10.34 11 9 9.66 9 8C9 6.34 10.34 5 12 5ZM12 19.2C9.5 19.2 7.29 17.92 6 15.98C6.03 13.99 10 12.9 12 12.9C13.99 12.9 17.97 13.99 18 15.98C16.71 17.92 14.5 19.2 12 19.2Z" fill="#f7c948"/>
                </svg>
              </div>
              <div class="chat-bubble-bot rounded-2xl rounded-tl-sm p-3 sm:p-4 max-w-[85%] sm:max-w-[70%] shadow-sm text-sm sm:text-base">
                <p style="color: #1e3a5f; white-space: pre-line;">${escapeHtml(msg.message)}</p>
              </div>
            </div>
          `;
        }
      });

      container.innerHTML = welcomeHTML + messagesHTML;
      container.scrollTop = container.scrollHeight;
    }

    function escapeHtml(text) {
      const div = document.createElement('div');
      div.textContent = text;
      return div.innerHTML;
    }

    function showChat() {
      document.getElementById('landing-page').classList.add('hidden');
      document.getElementById('chat-page').classList.add('show');
      document.getElementById('message-input').focus();
    }

    function showLanding() {
      document.getElementById('chat-page').classList.remove('show');
      document.getElementById('landing-page').classList.remove('hidden');
    }

    async function sendMessage(message) {
      if (!message.trim()) return;

      if (currentRecordCount >= 999) {
        showToast('Batas pesan tercapai. Silakan hapus beberapa pesan.', 'error');
        return;
      }

      const input = document.getElementById('message-input');
      const sendButton = document.getElementById('send-button');
      
      input.disabled = true;
      sendButton.disabled = true;

      const userMsg = {
        id: Date.now().toString(),
        message: message,
        sender: 'user',
        timestamp: new Date().toISOString()
      };

      const result = await window.dataSdk.create(userMsg);
      
      if (result.isError) {
        showToast('Gagal mengirim pesan. Silakan coba lagi.', 'error');
        input.disabled = false;
        sendButton.disabled = false;
        return;
      }

      input.value = '';

      showTypingIndicator();

      setTimeout(async () => {
        hideTypingIndicator();
        
        if (currentRecordCount >= 998) {
          showToast('Batas pesan hampir tercapai.', 'warning');
        }

        const botMsg = {
          id: (Date.now() + 1).toString(),
          message: getBotResponse(message),
          sender: 'bot',
          timestamp: new Date().toISOString()
        };

        const botResult = await window.dataSdk.create(botMsg);
        
        if (botResult.isError) {
          showToast('Gagal menerima respons.', 'error');
        }

        input.disabled = false;
        sendButton.disabled = false;
        input.focus();
      }, 1000 + Math.random() * 1000);
    }

    function sendQuickMessage(message) {
      sendMessage(message);
    }

    function showTypingIndicator() {
      const container = document.getElementById('chat-messages');
      const indicator = document.createElement('div');
      indicator.id = 'typing-indicator';
      indicator.className = 'flex gap-3 slide-up';
      indicator.innerHTML = `
        <div class="w-7 h-7 sm:w-8 sm:h-8 rounded-full flex-shrink-0 flex items-center justify-center" style="background: #1e3a5f;">
          <svg width="14" height="14" viewBox="0 0 24 24" fill="none" class="sm:w-4 sm:h-4">
            <path d="M12 2C6.48 2 2 6.48 2 12C2 17.52 6.48 22 12 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 12 2ZM12 5C13.66 5 15 6.34 15 8C15 9.66 13.66 11 12 11C10.34 11 9 9.66 9 8C9 6.34 10.34 5 12 5ZM12 19.2C9.5 19.2 7.29 17.92 6 15.98C6.03 13.99 10 12.9 12 12.9C13.99 12.9 17.97 13.99 18 15.98C16.71 17.92 14.5 19.2 12 19.2Z" fill="#f7c948"/>
          </svg>
        </div>
        <div class="chat-bubble-bot rounded-2xl rounded-tl-sm p-3 sm:p-4 shadow-sm">
          <div class="flex gap-1">
            <span class="w-2 h-2 rounded-full pulse-dot" style="background: #1e3a5f; animation-delay: 0s;"></span>
            <span class="w-2 h-2 rounded-full pulse-dot" style="background: #1e3a5f; animation-delay: 0.2s;"></span>
            <span class="w-2 h-2 rounded-full pulse-dot" style="background: #1e3a5f; animation-delay: 0.4s;"></span>
          </div>
        </div>
      `;
      container.appendChild(indicator);
      container.scrollTop = container.scrollHeight;
    }

    function hideTypingIndicator() {
      const indicator = document.getElementById('typing-indicator');
      if (indicator) indicator.remove();
    }

    async function clearChat() {
      const header = document.querySelector('#chat-page > div:first-child');
      const existingConfirm = document.getElementById('clear-confirm');
      if (existingConfirm) return;

      const confirmDiv = document.createElement('div');
      confirmDiv.id = 'clear-confirm';
      confirmDiv.className = 'absolute top-full left-0 right-0 p-3 flex items-center justify-between gap-2 flex-col sm:flex-row';
      confirmDiv.style.cssText = 'background: #fef3c7; z-index: 50;';
      confirmDiv.innerHTML = `
        <span class="text-xs sm:text-sm" style="color: #92400e;">Hapus semua pesan?</span>
        <div class="flex gap-2 text-xs sm:text-sm">
          <button onclick="confirmClear()" class="px-3 sm:px-4 py-1.5 rounded-lg font-medium text-white touch-feedback" style="background: #dc2626;">Hapus</button>
          <button onclick="cancelClear()" class="px-3 sm:px-4 py-1.5 rounded-lg font-medium touch-feedback" style="background: #e2e8f0; color: #1e3a5f;">Batal</button>
        </div>
      `;
      header.style.position = 'relative';
      header.appendChild(confirmDiv);
    }

    async function confirmClear() {
      cancelClear();
      
      for (const msg of chatMessages) {
        await window.dataSdk.delete(msg);
      }
      
      showToast('Chat berhasil dihapus', 'success');
    }

    function cancelClear() {
      const confirmDiv = document.getElementById('clear-confirm');
      if (confirmDiv) confirmDiv.remove();
    }

    function showToast(message, type = 'info') {
      const toast = document.createElement('div');
      toast.className = 'fixed left-4 right-4 sm:left-auto sm:right-auto sm:bottom-20 bottom-24 transform sm:translate-x-0 px-4 sm:px-6 py-3 rounded-lg sm:rounded-xl shadow-lg z-50 fade-in text-sm sm:text-base';
      
      const colors = {
        success: 'background: #22c55e; color: white;',
        error: 'background: #ef4444; color: white;',
        warning: 'background: #f7c948; color: #1e3a5f;',
        info: 'background: #1e3a5f; color: white;'
      };
      
      toast.style.cssText = colors[type] || colors.info;
      toast.textContent = message;
      document.body.appendChild(toast);
      
      setTimeout(() => {
        toast.style.opacity = '0';
        toast.style.transition = 'opacity 0.3s';
        setTimeout(() => toast.remove(), 300);
      }, 3000);
    }

    async function onConfigChange(config) {
      const c = { ...defaultConfig, ...config };
      
      document.getElementById('hero-title').textContent = c.hero_title;
      document.getElementById('hero-subtitle').textContent = c.hero_subtitle;
      document.getElementById('cta-button').querySelector('span').textContent = c.cta_button_text;
      document.getElementById('feature1-title').textContent = c.feature1_title;
      document.getElementById('feature2-title').textContent = c.feature2_title;
      document.getElementById('feature3-title').textContent = c.feature3_title;
      document.getElementById('footer-text').textContent = c.footer_text;
      
      document.body.style.fontFamily = `${c.font_family}, sans-serif`;
    }

    function mapToCapabilities(config) {
      const c = { ...defaultConfig, ...config };
      return {
        recolorables: [
          {
            get: () => c.background_color,
            set: (v) => window.elementSdk.setConfig({ background_color: v })
          },
          {
            get: () => c.primary_color,
            set: (v) => window.elementSdk.setConfig({ primary_color: v })
          },
          {
            get: () => c.accent_color,
            set: (v) => window.elementSdk.setConfig({ accent_color: v })
          },
          {
            get: () => c.text_color,
            set: (v) => window.elementSdk.setConfig({ text_color: v })
          },
          {
            get: () => c.secondary_text_color,
            set: (v) => window.elementSdk.setConfig({ secondary_text_color: v })
          }
        ],
        borderables: [],
        fontEditable: {
          get: () => c.font_family,
          set: (v) => window.elementSdk.setConfig({ font_family: v })
        },
        fontSizeable: {
          get: () => c.font_size,
          set: (v) => window.elementSdk.setConfig({ font_size: v })
        }
      };
    }

    function mapToEditPanelValues(config) {
      const c = { ...defaultConfig, ...config };
      return new Map([
        ['hero_title', c.hero_title],
        ['hero_subtitle', c.hero_subtitle],
        ['cta_button_text', c.cta_button_text],
        ['feature1_title', c.feature1_title],
        ['feature2_title', c.feature2_title],
        ['feature3_title', c.feature3_title],
        ['footer_text', c.footer_text]
      ]);
    }

    async function init() {
      if (window.elementSdk) {
        window.elementSdk.init({
          defaultConfig,
          onConfigChange,
          mapToCapabilities,
          mapToEditPanelValues
        });
      }

      if (window.dataSdk) {
        const result = await window.dataSdk.init(dataHandler);
        if (result.isError) {
          console.error('Failed to initialize Data SDK');
        }
      }

      document.getElementById('chat-form').addEventListener('submit', (e) => {
        e.preventDefault();
        const input = document.getElementById('message-input');
        sendMessage(input.value);
      });

      // Prevent zoom on input focus on iOS
      document.addEventListener('touchmove', (e) => {
        if (e.target.tagName !== 'INPUT' && e.target.tagName !== 'TEXTAREA') {
          e.preventDefault();
        }
      }, { passive: false });
    }

    init();
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9c9b77620370f853',t:'MTc3MDM4OTQ5NC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>